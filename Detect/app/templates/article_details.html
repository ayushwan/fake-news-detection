{% extends "base.html" %}

{% block head_extra %}
<style>
    .article-detail-card {
        border-radius: 10px;
    }
    .article-content-display {
        background-color: #f8f9fa;
        border: 1px solid #dee2e6;
        padding: 1.5rem;
        border-radius: 5px;
        max-height: 400px;
        overflow-y: auto;
        white-space: pre-wrap; /* Preserve whitespace and newlines */
        word-wrap: break-word; /* Break long words */
    }
    .meta-info span {
        display: inline-block;
        margin-right: 15px;
        color: #6c757d;
    }
    .result-badge.FAKE {
        background-color: #dc3545 !important;
        color: white;
    }
    .result-badge.REAL {
        background-color: #28a745 !important;
        color: white;
    }
    .result-badge.ERROR, .result-badge.NA {
        background-color: #ffc107 !important;
        color: black;
    }
</style>
{% endblock %}

{% block content %}
<div class="container mt-4">
    <div class="card shadow-sm article-detail-card animate__animated animate__fadeIn">
        <div class="card-header bg-light">
            <h3 class="mb-0">Article Details</h3>
        </div>
        <div class="card-body">
            <h4 class="card-title">
                {% if article.title %}
                    {{ article.title }}
                {% elif article.input_url %}
                    <a href="{{ article.input_url }}" target="_blank">{{ article.input_url }}</a>
                {% else %}
                    Submitted Text Snippet
                {% endif %}
            </h4>
            <hr>
            <div class="meta-info mb-3">
                <span><i class="fas fa-user me-1"></i> Submitted by: {{ article.author.username }}</span>
                <span><i class="fas fa-calendar-alt me-1"></i> Date: {{ article.submitted_at.strftime('%Y-%m-%d %H:%M') }}</span>
                <span><i class="fas fa-file-alt me-1"></i> Type: <span class="badge bg-secondary">{{ article.content_source|capitalize }}</span></span>
            </div>

            <div class="mb-3">
                <h5>Prediction Result: 
                    <span class="badge fs-6 result-badge {{ article.prediction_result }}">
                        {{ article.prediction_result if article.prediction_result else 'N/A' }}
                    </span>
                </h5>
                {% if article.prediction_result and article.prediction_result not in ['ERROR', 'N/A'] %}
                    <p class="mb-0"><strong>Confidence Score:</strong> {{ '%.2f'|format(article.confidence_score|float) }}%</p>
                {% endif %}
            </div>
            
            {% if display_content %}
                <h5 class="mt-4">Submitted Content:</h5>
                <div class="article-content-display">
                    {{ display_content }}
                </div>
            {% elif article.content_source == 'url' and article.input_url %}
                 <h5 class="mt-4">Submitted URL:</h5>
                 <p><a href="{{ article.input_url }}" target="_blank">{{ article.input_url }}</a></p>
                 <p class="text-muted"><small>Content was extracted from this URL for analysis. If you need to see the extracted text, it might be available to admins or stored differently.</small></p>
            {% else %}
                <p class="text-muted mt-3">No content to display for this submission type or content was not stored.</p>
            {% endif %}

        </div>
        <div class="card-footer bg-light text-end">
            <a href="{{ url_for('main.history') }}" class="btn btn-outline-secondary"><i class="fas fa-arrow-left me-1"></i> Back to History</a>
            {% if article.prediction_result and article.prediction_result not in ['ERROR', 'N/A'] %}
                <!-- Simplified share/download, or link back to a result page if that has more features -->
                <!-- <button class="btn btn-primary" onclick="alert('Share functionality placeholder')"><i class="fas fa-share-alt me-1"></i> Share</button> -->
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}